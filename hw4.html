<!DOCTYPE html>
<html>
<head>
<style>
	#info {
		position: absolute;
		top: 0px;
		width: 100%;
		padding: 10px;
		text-align: center;
		color: #ffff00
	}
	body {
		overflow:hidden
	}

</style>
</head>
<title>hw4</title>
<body>
<div id="info">Pick & Place</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r70/three.min.js"></script>
<script src="https://dl.dropboxusercontent.com/u/3587259/Code/Threejs/OrbitControls.js"></script>
<script src="https://jyunming-chen.github.io/tutsplus/js/KeyboardState.js"></script>
<script>

var camera, scene, renderer, controls;
var puck;

var raycaster;
var mouse = new THREE.Vector2();
var pickables = [];

init();
animate();

function init() {
	scene = new THREE.Scene();

	camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
	camera.position.z = 500;
	scene.add(camera);

	var gridXZ = new THREE.GridHelper(100, 10);
	gridXZ.setColors(new THREE.Color(0xff0000), new THREE.Color(0xffffff));
	scene.add(gridXZ);

	renderer = new THREE.WebGLRenderer();
	renderer.setSize(window.innerWidth, window.innerHeight);
	renderer.setClearColor(0x888888);

	controls = new THREE.OrbitControls(camera, renderer.domElement);

	document.body.appendChild(renderer.domElement);

	/////////////////////////////////////////////////////////////////////
	plane = new THREE.Mesh (new THREE.PlaneGeometry(200,200), new THREE.MeshBasicMaterial({visible:false}));
	scene.add (plane);
	plane.rotation.x = -Math.PI/2;
	pickables = [plane];

	puck = new THREE.Mesh (new THREE.CylinderGeometry (10,10,2,20), new THREE.MeshNormalMaterial());
	scene.add (puck);

	raycaster = new THREE.Raycaster();
	document.addEventListener('mousedown', onDocumentMouseDown, false);
}

function onDocumentMouseDown(event) {

	event.preventDefault();
	mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
	mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

	// find intersections
	raycaster.setFromCamera(mouse, camera);
	var intersects = raycaster.intersectObjects(pickables);
	if (intersects.length > 0) {
		puck.position.copy (intersects[0].point);
	}

}

function animate() {
	controls.update();
	requestAnimationFrame(animate);
	render();
}

function render() {
	renderer.render(scene, camera);
}

</script>
</body>
</html>